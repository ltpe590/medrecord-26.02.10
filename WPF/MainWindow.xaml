<Window x:Class="WPF.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:sys="clr-namespace:System.Windows;assembly=PresentationFramework"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:views="clr-namespace:WPF.Views"
    mc:Ignorable="d"
    Title="Patient Visit Management"
    Width="{x:Static sys:SystemParameters.PrimaryScreenWidth}"
    Height="{x:Static sys:SystemParameters.PrimaryScreenHeight}"
    Background="{StaticResource AppBackground}">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" MinWidth="90"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ═══ SIDEBAR NAV (4 tabs) ═══ -->
        <Grid Grid.Column="0" Background="{StaticResource AppBackground}">
            <Grid.RowDefinitions>
                <RowDefinition Height="2*"/>
                <RowDefinition Height="2*"/>
                <RowDefinition Height="2*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <RadioButton Grid.Row="0" x:Name="PatientsTabButton"
                         Content="Patients"     Tag="&#x1F464;"
                         Style="{StaticResource VerticalTabButton}"
                         GroupName="MainTabs"   IsChecked="True"
                         Checked="PatientsTab_Checked"/>

            <RadioButton Grid.Row="1" x:Name="AppointmentsTabButton"
                         Content="Appointments" Tag="&#x1F4C5;"
                         Style="{StaticResource VerticalTabButton}"
                         GroupName="MainTabs"
                         Checked="AppointmentsTab_Checked"/>

            <RadioButton Grid.Row="2" x:Name="VisitTabButton"
                         Content="Visit"        Tag="&#x1F4CB;"
                         Style="{DynamicResource VerticalTabButton}"
                         GroupName="MainTabs"
                         Checked="VisitTab_Checked"/>

            <RadioButton Grid.Row="3" x:Name="SettingsTabButton"
                         Content="Settings"     Tag="&#x2699;"
                         Style="{DynamicResource VerticalTabButton}"
                         GroupName="MainTabs"
                         Checked="SettingsTab_Checked"/>
        </Grid>

        <!-- ═══ MAIN CONTENT ═══ -->
        <Grid Grid.Column="1" Background="{StaticResource AppSurface2}">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Toolbar — only shown for patient-facing tabs, hidden on Settings -->
            <DockPanel x:Name="MainToolbar"
                       Grid.Row="0"
                       Background="{DynamicResource AppSurfaceDark}"
                       MinHeight="48"
                       LastChildFill="False">
                <Button x:Name="AddPatientButton"
                        Content="+ Add Patient"
                        Margin="10,7"
                        Style="{StaticResource BtnPrimary}"
                        Click="AddNewPatientButton_Click"
                        DockPanel.Dock="Left"/>
            </DockPanel>

            <!-- ── Patients tab ── -->
            <views:PatientsTabControl x:Name="PatientsTabContent"
                                      Grid.Row="1"
                                      Visibility="Visible"
                                      StartVisitRequested="PatientsTab_StartVisitRequested"/>

            <!-- ── Appointments tab ── -->
            <views:AppointmentsTabControl x:Name="AppointmentsTabContent"
                                          Grid.Row="1"
                                          Visibility="Collapsed"/>

            <!-- ── Visit tab ── -->
            <views:VisitTabControl x:Name="VisitTabContent"
                                   Grid.Row="1"
                                   Visibility="Collapsed"
                                   SelectedPatient="{Binding SelectedPatient}"
                                   HasSelectedPatient="{Binding HasSelectedPatient}"
                                   DataContext="{Binding CurrentVisit}"
                                   SaveVisitRequested="VisitTab_SaveVisitRequested"
                                   CompleteVisitRequested="VisitTab_CompleteVisitRequested"
                                   PauseVisitRequested="VisitTab_PauseVisitRequested"/>

            <!-- ── Settings tab ── -->
            <views:SettingsTabControl x:Name="SettingsTabContent"
                                      Grid.Row="1"
                                      Visibility="Collapsed"/>
        </Grid>
    </Grid>
</Window>
